# MicroservicesApp
üöÄ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
1Ô∏è‚É£ –ü—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–∫–∏
–ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ä–∞–±–æ—Ç—ã —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã:

Docker –∏ Docker Compose
.NET SDK (–µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–∞—è —Å–±–æ—Ä–∫–∞)
EF Core CLI (–µ—Å–ª–∏ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä–∞–±–æ—Ç–∞ —Å –º–∏–≥—Ä–∞—Ü–∏—è–º–∏):

dotnet tool install --global dotnet-ef

2Ô∏è‚É£ –°–æ–∑–¥–∞–Ω–∏–µ –æ–±—â–µ–π —Å–µ—Ç–∏
–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã —Ä–∞–±–æ—Ç–∞—é—Ç –≤ —Å–µ—Ç–∏ microservices_network. –ï—Å–ª–∏ –æ–Ω–∞ –Ω–µ —Å–æ–∑–¥–∞–Ω–∞, —Å–æ–∑–¥–∞–π—Ç–µ –µ—ë:

docker network create microservices_network

3Ô∏è‚É£ –ó–∞–ø—É—Å–∫ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö PostgreSQL —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ —Å –ø–æ–º–æ—â—å—é —Ñ–∞–π–ª–∞ docker-compose.db.yml:

docker compose -f docker-compose.db.yml up -d

–ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∞–ø—É—â–µ–Ω:

docker ps

–ï—Å–ª–∏ postgres –Ω–µ –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è –∫ —Å–µ—Ç–∏, –¥–æ–±–∞–≤–ª—è–µ–º –µ–≥–æ –≤—Ä—É—á–Ω—É—é:

docker network connect microservices_network postgres

4Ô∏è‚É£ –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π
–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –ë–î –æ–±–Ω–æ–≤–ª—è–µ–º —Å—Ö–µ–º—É –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, –ø—Ä–∏–º–µ–Ω—è—è –º–∏–≥—Ä–∞—Ü–∏–∏:

dotnet ef database update --project AuthService/AuthService.csproj

‚úÖ –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ —Ñ–∞–π–ª–µ appsettings.json –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —É–∫–∞–∑–∞–Ω ConnectionStrings__DefaultConnection.

5Ô∏è‚É£ –ó–∞–ø—É—Å–∫ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤
–ö–æ–≥–¥–∞ –ë–î –∑–∞–ø—É—â–µ–Ω–∞, –∑–∞–ø—É—Å–∫–∞–µ–º –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã:

docker compose up -d --build

üëâ –§–ª–∞–≥ --build –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç –ø–µ—Ä–µ—Å–æ–±–∏—Ä–∞—Ç—å –æ–±—Ä–∞–∑—ã –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º.

6Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã —Å–µ—Ä–≤–∏—Å–æ–≤
üìå –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL –∏–∑ auth_service

docker exec -it auth_service getent hosts postgres

‚úÖ –ï—Å–ª–∏ –≤–µ—Ä–Ω—ë—Ç—Å—è IP-–∞–¥—Ä–µ—Å postgres, –∑–Ω–∞—á–∏—Ç, —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ.

üìå –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–∞–±–ª–∏—Ü—ã –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

docker exec -it postgres psql -U user -d authdb -c "\dt"

7Ô∏è‚É£ –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤
–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã (–±–µ–∑ —É–¥–∞–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö):

docker compose down

–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –ë–î:

docker compose -f docker-compose.db.yml down

–£–¥–∞–ª–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ (‚ö†Ô∏è –≤–∫–ª—é—á–∞—è –±–∞–∑—É!):

docker compose -f docker-compose.db.yml down -v

8Ô∏è‚É£ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞ –∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
–ï—Å–ª–∏ –∏–∑–º–µ–Ω–∏–ª—Å—è –∫–æ–¥, –ø–µ—Ä–µ—Å–æ–±–∏—Ä–∞–µ–º —Å–µ—Ä–≤–∏—Å—ã:

docker compose up -d --build --force-recreate

–ï—Å–ª–∏ –∏–∑–º–µ–Ω–∏–ª–∞—Å—å –ë–î, –ø–µ—Ä–µ—Å–æ–±–∏—Ä–∞–µ–º –µ—ë:

docker compose -f docker-compose.db.yml up -d --build --force-recreate